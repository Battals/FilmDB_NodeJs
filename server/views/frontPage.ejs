<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FilmDB</title>
  <script src="/client/JS/client.js"></script>
  <script src="https://www.youtube.com/iframe_api"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
  <link rel="stylesheet" type="text/css" href="/client/CSS/style.css">
</head>

<body>
  <header>
    <a href="/">
      <h1 style="font-family: FontAwesome;">FilmDB.dk</h1>
    </a>
    <nav>
      <% if (isLoggedIn) { %>
      <a href="/">Populære film</a>
      <a href="/upcomingMovies">Kommende film</a>
      <a href="/findMovie">Find film</a>
      <a href="/myProfile">Min side</a>
      <a href="/myAccount">Min profil</a>
      <a href="/movieChat">Chat</a>
      <a style="color: red;" href="/signout">Log ud</a>
      <% 
      } else {
      %> 
      <a href="login">Login</a>
      <a href="/register">Opret bruger</a>
      <a href="/">Populære film</a>
      <a href="upcomingMovies">Kommende film</a>
      <a href="findMovie">Find film</a>
      <a href="/movieChat">Chat</a>
      <% } %>
    </nav>
  </header>

  <h1 style="margin: 15px;">Populære film</h1>

  <div id="myModal" class="modal">
    <!-- ... (your modal content) ... -->
  </div>

  <div class="movie-list">
    <div class="button-div"></div>
  </div>

  <script>
    async function displayPopular() {
      const response = await fetch("/popularMovies");
      if (response.ok) {
        const data = await response.json();
        displayMovies(data);
      } else {
        toastr.error("Der opstod en fejl i indlæsningen af Populære film");
      }
    }

    displayPopular();

    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.has('loggedOut')) {
      localStorage.removeItem("user_name");
      localStorage.removeItem("access_token");
      toastr.success("Du er nu logget ud");
    }
  </script>
</body>

</html>
